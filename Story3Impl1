This is the implementation that fixes failing test


Refactored


Implemented test 2

